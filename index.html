<!DOCTYPE html>

<head>

    <script type="text/javascript" src="https://d3js.org/d3.v7.min.js"></script>
    <script src="sp.js"></script>
    <script src="select.js"></script>
    <link rel="icon" type="image/x-icon" href="fav.ico">
    <style>
        * {
            font-family: 'Trebuchet MS', 'Lucida Sans Unicode', 'Lucida Grande', 'Lucida Sans', Arial, sans-serif;
            margin: 0;
            padding: 0;
        }

        body {
            background: linear-gradient(90deg, rgb(125, 125, 255), rgb(175, 175, 255));
        }

        .bar {
            transition-duration: 0.2s;
        }

        .bar:hover {
            fill: rgba(255, 255, 255, 0.2);
        }

        #sas {
            background-color: rgb(116, 28, 230);
            width: min-content;
            margin: auto;
        }

        #bosque {
            background-color: rgb(35, 214, 214);
        }

        #divbutton {
            background-color: rgb(125, 125, 255);
            padding: 10px;
        }

        form {
            background-color: rgb(196, 241, 104);
            box-sizing: content-box;
            padding: 10px;
        }

        form li {
            display: inline-block;
            list-style: none;
        }

        select {
            width: 100px;

        }

        .sas-div {
            display: inline-block;
        }
    </style>
</head>

<body>
    <main>
        <div id="sas">
            <div id="bosque">
                <div class="sas-div">
                    <form id="forma">
                        <ul>
                            <li>
                                <div>
                                    <select name="age">
                                        <option value="2022" selected="true">2022</option>
                                    </select>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <select name="ciclo">
                                        <option value=""> </option>
                                        <option value="ciclo_i">Ciclo I</option>
                                        <option value="ciclo_ii">Ciclo II</option>
                                        <option value="ciclo_iii">Ciclo III</option>
                                    </select>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <select name="examen">
                                        <option value=""> </option>
                                        <option value="examen_i">1° Examen</option>
                                        <option value="examen_ii">2° Examen</option>
                                        <option value="examen_iii">3° Examen</option>
                                    </select>
                                </div>
                            </li>
                            <li>
                                <div>
                                    <select name="zona">
                                        <option value=""> </option>
                                        <option value="zona_i">Zona I</option>
                                        <option value="zona_ii">Zona II</option>
                                        <option value="zona_iii">zona III</option>
                                    </select>
                                </div>
                            </li>
                        </ul>
                    </form>

                </div>
                <div class="sas-div">
                    <div id="divbutton">
                        <button id="sender">Try it</button>
                    </div>
                </div>
            </div>
        </div>
    </main>

    <script>

    </script>
    <script>
        const sender = document.getElementById('sender');
        const form = (document.forms)[0]    
        const form_elements_length = form.length
        let list_de_sitios = Array()
        let is_again_clicked = ""

        let selecteds = [0,2,3,3]        

        var b = form.getElementsByTagName('select')
        
        for (let i = 2; i < b.length; i++) {
            const element = b[i];
            element.disabled = true
        }

        b[1].addEventListener('change', function () {
            if(b[1].value != ""){
                b[2].disabled = false
            }else{
                for (let i = 2; i < b.length; i++) {
                    const element = b[i];
                    element.value = ""
                    element.disabled = true
                }
            }
        })
        b[2].addEventListener('change', function () {
            if(b[2].value != ""){
                b[3].disabled = false
            }else{
                for (let i = 2; i < b.length; i++) {
                    const element = b[i];
                    element.value = ""
                    element.disabled = true
                }
            }
        })

        function consoler() {
            var arr = ""
            var sear = "https://protonianosaurio.github.io/informacion/j_sons/"
            
            let llenos = 0
            while (form[llenos+1].value != "") {
                const value = form[llenos].value
                sear += value + "/"
                arr += value
                if(llenos == 2){
                    llenos+=1
                    break
              ""  }
                llenos+=1
            }

            if(llenos <= 2){
                sear += (form[llenos].value+"/"+form[llenos].value + ".json")
            }else{
                sear += (form[llenos].value + ".json")
            }

            arr += form[llenos].value
            if (is_again_clicked !== arr) {
                is_again_clicked = arr
                console.log(sear)
            }
        }
        sender.addEventListener("click", consoler)

    </script>
    <script>

        const k = 40;
        const w = 16 * k;
        const h = 9 * k;
        const padding = 30;
        var database = [53, 64, 98, 74, 61, 34, 39, 10, 15, 160, 5];
        database = acomodador(database, 0);
        const svg = d3.select('#sas')
            .append("svg")
            .attr("width", w)
            .attr("height", h)
            .style("background", "rgb(125, 125, 255)")

        svg.selectAll("rect")
            .data(database)
            .enter()
            .append("rect")
            .attr("class", "bar")
            .attr("fill", "rgba(255, 255, 255, 0.5")
            .attr("width", 35)
            .attr("height", (d) => d*1.5)
            .attr("x", (d, i) => i * 40 + padding + 60)
            .attr("y", (d) => h - (d*1.5 + padding))
            .append("title")
            .text((d) => d)

        //svg.append("path")
        //    .attr("fill", "none")
        //    .attr("stroke", "black")
        //    .attr("stroke-width", 1.5)
        //    .attr("stroke-miterlimit", 1)
        //    .attr("d", masonte(database, h-30))

        svg.selectAll("text")
            .data(database)
            .enter()
            .append("text")
            .text((d) => d)
            .attr("x", (d, i) => {
                var ds = (d + "");
                if (ds.length >= 3) {
                    return i * 40 + padding + 5 +60
                } else if (ds.length === 2) {
                    return i * 40 + padding + 10 +60
                } else {
                    return i * 40 + padding + 16 +60
                }
            })
            .attr("y", (d) => h - (d*1.5 + padding) - 5)
    </script>
</body>
